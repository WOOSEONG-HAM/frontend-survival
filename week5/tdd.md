# 5주차 TDD

## 학습 키워드

- TDD란
- Jest
- Describe - Context - It 패턴
- 단위테스트란

## TDD (Test Driven Development)

> TDD는 Test Driven Development의 약자로 ‘테스트 주도 개발’, 개발하는 방식을 이야기한다. 쉽게 말해서 예상하거나, 원하는대로 동작하는지 확인 및 점검을하는 것 이다. 수학문제를 풀 때 주로 하는 검산과 같은 맥락이다. 이 검산을 자동으로 계속해서 반복하여 확인을 해주는 것이다.

### TDD 종류

- 유닛 테스트(Unit Test): 각각의 함수, 클래스 같은 작은 단위의 테스트
- 통합 테스트(Integeration Test): 각각의 함수들이 모여 하나의 상호작용하며, 동작을 하는지 확인하는 테스트
- E2E(end-to-end): 사용자 테스트로 사용자의 입장에서 테스트

### **TDD Cycle**

1. Red → 실패하는 테스트 코드를 작성. 인터페이스와 스펙에 집중한다.
2. Green → 재빨리 테스트를 통과시킨다. 올바른 방법이 아니어도 괜찮다.
3. Refactor → 리팩터링을 통해 코드를 올바르게 만든다. TDD에서 가장 중요한 부분이지만, 간과될 때가 많다.

## Jest

> **Jest**는 페이스북에서 만들어서 React와 더불어 많은 자바스크립트 개발자들로 부터 좋은 반응을 얻고 있는 테스팅 라이브러리다.
>
> 출시 초기에는 프론트앤드에서 주로 쓰였지만 최근에는 백앤드에서도 기존의 자바스크립트 테스팅 라이브러리를 대체하고 있다.

\***\*JEST 기본 문법\*\***

- test파일은 **테스트할함수파일명.test.js** 로 생성한다.
- **describe** 는 테스트 그룹을 묶어주는 역할을 하고, 그안의 콜백함수 내에 테스트에 쓰일 가자 변수,객체들을 선언하여 일회용으로 사용 할 수 있다.
- **toXxx** 부분에서 사용되는 함수를 흔히 **Test Mathcher**라고 하는데, 위에서 사용된 toEqual() 함수는 값을 비교할때 사용한다.**toXxx** 부분에서 사용되는 함수를 흔히 **Test Mathcher**라고 하는데, 위에서 사용된 toEqual() 함수는 값을 비교할때 사용한다.

<aside>
💡 즉, **expect(a + b).toEqual(3);** 이라는 말은 a+b의 기대값이 3과 같으면 true 를 의미한다고 보면 된다.

</aside>

테스트 케이스를 정의할 때 크게 두 가지 방법을 사용

```jsx
//test 함수로 개별 테스트를 나열하는 방식.
test('add', () => {
  expect(add(1, 2)).toBe(3);
});
```

BDD 스타일로 테스트 대상과 행위를 명확히 드러내자.

```jsx
//BDD 스타일로 주체-행위 중심으로 테스트를 조직화하는 방식.
describe('add', () => {
  it('returns sum of two numbers', () => {
    expect(add(1, 2)).toBe(3);
  });
});
```

## **Describe-Context-It 패턴**

> **Describe-Context-It 패턴**은 코드의 행동을 설명하는 테스트 코드를 작성한다.
> 다른 BDD 패턴인 `Given` - `When` - `Then`과 비슷한 철학을 갖고 있지만 미묘하게 다른 점이 있다.
> `Describe` - `Context` - `It` 은 상황을 설명하기보다는 테스트 대상을 주인공 삼아 행동을 더 섬세하게 설명하는 데에 적합하다.

| 키워드   | 설명                                |
| -------- | ----------------------------------- |
| Describe | 설명할 테스트 대상을 명시한다.      |
| Context  | 테스트 대상이 놓인 상황을 설명한다. |
| It       | 테스트 대상의 행동을 설명한다.      |

- 영어로 `Context`문을 작성할 때에는 반드시 `with` 또는 `when`으로 시작하도록 한다.
- `It` 구문은 `It returns true`, `It responses 404`와 같이 심플하게 설명할수록 좋다.

```jsx
Describe("Sum", func() {
  Context("With 300 and 200", func() {
    It("returns 500", func() {
      Expect(Sum(300, 200)).To(Equal(500))
    })
  })

  Context("With -300 and 200", func() {
    It("returns -100", func() {
      Expect(Sum(-300, 200)).To(Equal(-100))
    })
  })
})

// 결과
// Sum 함수는,
// 입력으로 300과 200이 주어지면,
// 500을 리턴한다.
// 입력으로 -300과 200이 주어지면,
// -100을 리턴한다.
```

## 단위테스트

**단위 테스트(Unit Test)**는 **하나의 모듈을 기준으로 독립적으로 진행되는 가장 작은 단위의 테스트**이다. 여기서 모듈은 애플리케이션에서 작동하는 **하나의 기능 또는 메소드**로 이해할 수 있다. 예를 들어 웹 애플리케이션에서 로그인 메소드에 대한 독립적인 테스트가 1개의 단위테스트가 될 수 있다.

즉, 단위 테스트는 애플리케이션을 구성하는 하나의 기능이 올바르게 동작하는지를 독립적으로 테스트하는 것으로, "어떤 기능이 실행되면 어떤 결과가 나온다" 정도로 테스트를 진행한다.

### 좋은 단위 테스트의 특징

일반적으로 요구 사항은 계속해서 변하고, 그에 맞춰 우리의 코드 역시 변경되어야 한다. 하지만 실제 코드를 변경한다는 것은 잠재적인 버그가 발생할 수 있음을 내포하는데, **좋은 테스트 코드가 있다면 변경된 코드를 검증**함으로써 이를 해결할 수 있다. 또한 실제 코드가 변경되면 테스트 코드 역시 변경이 필요할 수 있는데, 이러한 이유로 우리는 테스트 코드 역시 가독성있게 작성할 필요가 있다.

그렇기에 테스트를 작성하는 경우에는 다음을 준수하는 것이 좋다.

1. 1개의 테스트 함수에 대해 assert를 최소화하라
2. 1개의 테스트 함수는 1가지 개념 만을 테스트하라
